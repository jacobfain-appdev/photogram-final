<h1>List of users</h1>


<table border ="1">
  <tr>
    <th>
      Username
    </th>
    <th>
      Private?
    </th>
    <th>
    </th>
    <th>
    </th>
  </tr>
 <% @users.each do |user|%>
  <tr>
    <td>
      <%=user.username%>
    </td>
    <td>
      <%if user.private == false%>
          No
        <%else%>  
          Yes
        <%end%>
    </td>
    
    <td>
      <%if @current_user == nil%>
      <%elsif @current_user.sent_follow_requests.where({:recipient_id=>user.id}).at(0) == nil %>
        <form action ="/insert_follow_request" method ="post">
          <input type = "hidden" name ="query_recipient_id" value = "<%=user.id%>">
          <button>Follow</button>
        </form>
      <%elsif @current_user.sent_follow_requests.where({:recipient_id=>user.id}).at(0).status == "accepted"%>
        <a href = "/delete_follow_request/<%=@current_user.sent_follow_requests.where({:recipient_id=>user.id}).at(0).id%>">Unfollow</a>
      <%elsif @current_user.sent_follow_requests.where({:recipient_id=>user.id}).at(0).status == "pending"%>  
        Request sent. Cancel     
      <%end%>
    </td>
    <td>

   <a href= "/users/<%=user.username%>">Show details</a>
    </td>
  </tr>
  <%end%>
</table>